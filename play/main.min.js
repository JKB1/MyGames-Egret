var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},RankLayer=function(t){function e(){var e=t.call(this)||this;return e.once(eui.UIEvent.COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.closeBtn.once(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t)},this)},e.prototype.onPostComplete=function(t){this.rankList=[];for(var e=0,i=t.ranking.length;i>e;e++){var n="";switch(e){case 0:n="p8_01_png";break;case 1:n="p8_02_png";break;case 2:n="p8_03_png";break;default:n=""}var r=t.ranking[e].rowNo|e+1,o="http://cdn.gph5.com/headImgDir/"+t.ranking[e].openid+".png",s=t.ranking[e].name,a=t.ranking[e].score;this.rankList.push({linebox:n,portrait:o,No:r,name:s,score:a})}this.list.dataProvider=new eui.ArrayCollection(this.rankList),this.list.itemRenderer=RankItem},e}(eui.Component);__reflect(RankLayer.prototype,"RankLayer",["eui.UIComponent","egret.DisplayObject"]);var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ImgData=function(t){function e(){var e=t.call(this)||this;return e.isSuper=!1,e.superNum=1,e}return __extends(e,t),e}(egret.Bitmap);__reflect(ImgData.prototype,"ImgData");var LineData=function(){function t(){}return t.getLineToRow=function(t,e){var i=new egret.Bitmap(RES.getRes("LinkL"+t.id+"0_png"));return 1==e.xDirection?i.x=t.x+t.width/3:-1==e.xDirection&&(i.x=t.x+t.width/6-t.width),i.y=t.y,i},t.getLineToCol=function(t,e){var i=new egret.Bitmap(RES.getRes("LinkL"+t.id+"1_png"));return i.x=t.x-t.width/7,1==e.yDirection?i.y=t.y+t.height/3:-1==e.yDirection&&(i.y=t.y-t.height+t.height/6),i},t.getLineToLeftSlash=function(t,e){var i=new egret.Bitmap(RES.getRes("LinkL"+t.id+"3_png"));return 1==e.xDirection?-1==e.yDirection&&(i.x=t.x,i.y=t.y-t.height):-1==e.xDirection&&1==e.yDirection&&(i.x=t.x-t.width,i.y=t.y+t.height/8),i},t.getLineToRightSlash=function(t,e){var i=new egret.Bitmap(RES.getRes("LinkL"+t.id+"2_png"));return 1==e.xDirection?1==e.yDirection&&(i.x=t.x+t.width/8,i.y=t.y+t.height/8):-1==e.xDirection&&-1==e.yDirection&&(i.x=t.x-t.width,i.y=t.y-t.height),i},t}();__reflect(LineData.prototype,"LineData");var OverAnimalData=function(t){function e(){var e=t.call(this,RES.getRes("p5_03_png"))||this;return e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){egret.Tween.get(this,{loop:!0}).to({texture:RES.getRes("p5_02_png")},500).to({texture:RES.getRes("p5_03_png")},500)},e}(egret.Bitmap);__reflect(OverAnimalData.prototype,"OverAnimalData");var SoundControl=function(){function t(){}return t.bgPlay=function(){this.bgSound||(this.bgSound=RES.getRes("Bgmusic_mp3"),this.bgSound.type=egret.Sound.MUSIC),this.bgStop(),this.bgSoundChannel=this.bgSound.play(0,0)},t.bgStop=function(){this.bgSoundChannel&&(this.bgSoundChannel.stop(),this.bgSoundChannel=null)},t}();__reflect(SoundControl.prototype,"SoundControl");var AdLayer=function(t){function e(e){var i=t.call(this)||this,n=new egret.Bitmap(e);i.addChild(n);var r=new egret.Bitmap(RES.getRes("AdClose_png"));r.x=egret.MainContext.instance.stage.stageWidth-r.width-20,r.y=20,i.addChild(r),r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,i.CloseCallFun,i);var o=i;return i.Timeout=setTimeout(function(){o.parent.removeChild(o),r.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.CloseCallFun,r)},1e3),i}return __extends(e,t),e.prototype.CloseCallFun=function(){clearTimeout(this.Timeout),this.parent.removeChild(this)},e}(egret.Sprite);__reflect(AdLayer.prototype,"AdLayer");var AnimationLayer=function(){function t(){}return t}();__reflect(AnimationLayer.prototype,"AnimationLayer");var AttentionLayer=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.alreadyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t)},this),this.nowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.attentionEvt,this)},e.prototype.attentionEvt=function(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0,0,0,0.5)";var e=document.createElement("img");e.style.position="absolute",e.style.top="20px",e.style.right="20px",e.src="resource/material/p1/Close.png",e.style.width="40px",t.appendChild(e),e.addEventListener("click",function(){document.body.removeChild(t)});var i=document.createElement("img");i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.maxWidth="80%",i.addEventListener("load",function(){i.style.left=(t.offsetWidth-i.width)/2+"px",i.style.top=(t.offsetHeight-i.height)/2+"px"}),t.appendChild(i),document.body.appendChild(t)},e}(eui.Component);__reflect(AttentionLayer.prototype,"AttentionLayer",["eui.UIComponent","egret.DisplayObject"]);var AwardLayer=function(t){function e(e,i,n){var r=t.call(this)||this;return r.isCard=n,r.str=e,r.callFun=i,r.addEventListener(eui.UIEvent.CREATION_COMPLETE,r.init,r),r}return __extends(e,t),e.prototype.init=function(){var t=this;this.getCardBtn.visible=!1,this.IknowBtn.visible=!1,this.isCard?this.getCardBtn.visible=!0:this.IknowBtn.visible=!0,this.TextLabel.text=this.str,this.getCardBtn.once(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t),t.callFun&&t.callFun()},this),this.IknowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t),t.callFun&&t.callFun()},this)},e}(eui.Component);__reflect(AwardLayer.prototype,"AwardLayer",["eui.UIComponent","egret.DisplayObject"]);var EditerLayer=function(t){function e(e){var i=t.call(this)||this;return i.callFun=e,i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.init,i),i}return __extends(e,t),e.prototype.init=function(){this.inputPhone.inputType=egret.TextFieldInputType.TEL,this.confirmBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.confirmEvt,this)},e.prototype.confirmEvt=function(){this.inputName.text,this.inputPhone.text},e}(eui.Component);__reflect(EditerLayer.prototype,"EditerLayer",["eui.UIComponent","egret.DisplayObject"]);var GiftItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.ItemRenderer);__reflect(GiftItem.prototype,"GiftItem");var GiftLayer=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent&&t.parent.removeChild(t)},this),this.giftsList=[];this.list.itemRenderer=GiftItem},e}(eui.Component);__reflect(GiftLayer.prototype,"GiftLayer",["eui.UIComponent","egret.DisplayObject"]);var PopupLayer=function(t){function e(e,i){var n=t.call(this)||this;return n.str=e,n.callFun=i,n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.init,n),n}return __extends(e,t),e.prototype.init=function(){var t=this,e=egret.Tween.get(this.PopupLayerAni);e.to({y:198},300),this.TextLabel.text=this.str,this.IknowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t),t.callFun&&t.callFun()},this)},e}(eui.Component);__reflect(PopupLayer.prototype,"PopupLayer",["eui.UIComponent","egret.DisplayObject"]);var RankItem=function(t){function e(){var e=t.call(this)||this;return e.once(eui.UIEvent.CREATION_COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this.icon.width/2,e=new egret.Shape;e.graphics.beginFill(255),e.graphics.drawCircle(this.icon.x+t,this.icon.y+t,t),e.graphics.endFill(),this.addChild(e),this.icon.mask=e},e}(eui.ItemRenderer);__reflect(RankItem.prototype,"RankItem");var DirectionData=function(){function t(t,e){this.xDirection=t,this.yDirection=e}return t}();__reflect(DirectionData.prototype,"DirectionData");var RuleLayer=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e.skinName="resource/layout/RuleLayer.exml",e}return __extends(e,t),e.prototype.init=function(){var t=this;this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t)},this)},e}(eui.Component);__reflect(RuleLayer.prototype,"RuleLayer",["eui.UIComponent","egret.DisplayObject"]);var ShareLayer=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.IknowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.parent.removeChild(t)},this)},e}(eui.Component);__reflect(ShareLayer.prototype,"ShareLayer",["eui.UIComponent","egret.DisplayObject"]);var TipsLayer=function(t){function e(e){var i=t.call(this)||this;return i.callFun=e,i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.init,i),i}return __extends(e,t),e.prototype.init=function(){var t=this,e=egret.Tween.get(this.tips);e.to({scaleX:1,scaleY:1},600).call(function(){t.tips.addEventListener(egret.TouchEvent.TOUCH_TAP,t.playEvt,t)})},e.prototype.playEvt=function(){this.parent;this.parent.removeChild(this),this.callFun&&this.callFun()},e}(eui.Component);__reflect(TipsLayer.prototype,"TipsLayer",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=this,e=640,i=1008,n="resource/assets/LoadRes/",r=this.LoadResource(n+"bg.jpg");this.addChild(r);var o=this.LoadResource(n+"progressBox.png",function(t){t.x=(e-t.width)/2,t.y=(i-t.height)/2+40});this.addChild(o);var s=this.LoadResource(n+"progress.png",function(r){r.x=(e-r.width)/2,r.y=(i-r.height)/2+40,t.startPoint=r.x;var o=new egret.Bitmap(r.texture);t.addChild(o),r.mask=o,o.x=r.x-o.width,o.y=r.y,t.maskLayer=o;var s=t.LoadResource(n+"tips.png",function(e){e.anchorOffsetX=e.width/2,e.x=t.startPoint,e.y=(i-e.height)/2});t.addChild(s),t.tips=s,t.textField&&(t.textField.x=t.tips.x,t.textField.y=t.tips.y+4,t.textField.anchorOffsetX=t.textField.width/2,t.addChildAt(t.textField,99))});this.addChild(s);var a=this.LoadResource(n+"text.png",function(t){t.x=(e-t.width)/2,t.y=(i-t.height)/2+90});this.addChild(a),this.textField=new egret.TextField,this.textField.size=22,this.textField.anchorOffsetX=this.textField.width/2,this.textField.text="0%",this.textField.textAlign="center"},e.prototype.LoadResource=function(t,e){var i=new egret.Bitmap,n=new egret.URLLoader;return n.addEventListener(egret.Event.COMPLETE,function(t){var n=t.target,r=n.data;i.texture=r,e&&e(i)},this),n.dataFormat=egret.URLLoaderDataFormat.TEXTURE,n.load(new egret.URLRequest(t)),i},e.prototype.setProgress=function(t,e){var i=Math.floor(t/e*100);this.textField.text="Loading..."+t+"/"+e,this.maskLayer&&(this.maskLayer.x=this.startPoint-this.maskLayer.width+this.maskLayer.width/e*t,this.tips&&(this.tips.x=this.startPoint+this.maskLayer.width/e*t,this.textField.text=i.toString()+"%",this.textField.x=this.tips.x,this.textField.y=this.tips.y+4,this.textField.anchorOffsetX=this.textField.width/2))},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.createGroup("preloadRes",["preload","serverImg"]),RES.loadGroup("preloadRes")},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){"preloadRes"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preloadRes"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){SceneControl.run(new HomeScene)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var addSeverImg=function(){function t(t){this.configData={groups:[],resources:[]},this.configData.groups.push({keys:"",name:t})}return t.prototype.addRes=function(t,e,i){this.configData.groups[0].keys+=t+",",this.configData.resources.push({name:t,type:e,url:i})},t.prototype.endConfig=function(){var t=this.configData.groups[0].keys.length;this.configData.groups[0].keys.slice(t-1,1),RES.parseConfig(this.configData)},t}();__reflect(addSeverImg.prototype,"addSeverImg");var egret;!function(t){var e=function(e){function i(i){var n=e.call(this)||this;return n.initializeBaseData(),n.Bitmap=i,n.frameRate=t.MainContext.instance.stage.frameRate,n}return __extends(i,e),i.prototype.initializeBaseData=function(){this.Batch_Texturl=[],this.loop=!1,this.interval=0,this.TimeRecord=0,this.texturlLength=0,this.isPlayAnimation=!1,this.currentTexturlIndex=0},i.prototype.playAnimation=function(e,i){this.stopAnimation(),this.initializeBaseData(),"undefined"==typeof e.loop&&(e.loop=!1),"undefined"==typeof e.interval&&(e.interval=.3),this.Bitmap.texture=e.texturl[0],this.Batch_Texturl=e.texturl,this.loop=e.loop,this.interval=1e3*e.interval,this.texturlLength=this.Batch_Texturl.length,this.callFunc=i,this.addEventListener(t.Event.ENTER_FRAME,this.update,this)},i.prototype.update=function(t){if(this.TimeRecord+=1e3/this.frameRate,this.TimeRecord>=this.interval){if(this.isPlayAnimation=!0,this.TimeRecord=0,this.currentTexturlIndex++,this.currentTexturlIndex>=this.texturlLength){if(!this.loop)return void this.stopAnimation();this.currentTexturlIndex=0}this.Bitmap.texture=this.Batch_Texturl[this.currentTexturlIndex]}},i.prototype.stopAnimation=function(){this.isPlayAnimation&&this.removeEventListener(t.Event.ENTER_FRAME,this.update,this),this.isPlayAnimation=!1,this.currentTexturlIndex=0,this.TimeRecord=0,this.callFunc&&this.callFunc()},i}(t.DisplayObjectContainer);t.Animation=e,__reflect(e.prototype,"egret.Animation");var i=function(){function t(){this.loop=!1,this.interval=.1}return t}();t.AnimationData=i,__reflect(i.prototype,"egret.AnimationData")}(egret||(egret={}));var Cookie=function(){function t(){}return t.setCookie=function(t,e,i){var n="undefined"==typeof i?null:i;if(null!=n){var r=new Date;r.setTime(r.getTime()+1e3*n*3600*24)}document.cookie=t+"="+window.escape(e)+(null==n?"":"; expires="+r.toGMTString())},t.getCookie=function(t){var e,i=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(i))?decodeURIComponent(e[2]):null},t.deleteCookie=function(e){var i=new Date;i.setTime(i.getTime()-864e5),t.setCookie(e,"",i)},t.setLocalStorage=function(t,e){egret.localStorage.setItem(t,e)},t.getLocalStorage=function(t){return egret.localStorage.getItem(t)},t.deleteLocalStorage=function(t){egret.localStorage.removeItem(t)},t}();__reflect(Cookie.prototype,"Cookie");var GameData=function(){function t(){}return Object.defineProperty(t,"stageW",{get:function(){return egret.MainContext.instance.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"stageH",{get:function(){return egret.MainContext.instance.stage.stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fps",{get:function(){return egret.MainContext.instance.stage.frameRate},enumerable:!0,configurable:!0}),t}();GameData.isStartWindows=!1,GameData.isShowGiftLayer=!1,__reflect(GameData.prototype,"GameData");var JsonpReq=function(){function t(){}return t.process=function(e,i,n){var r=this;t.completeCall["call_"+t._regID]=function(e){i.bind(void 0==typeof n?r:n)(e),t._callBackCount++,t._callBackCount==t._regID&&(t.completeCall={})},t.startLoader(e,t._regID++)},t.startLoader=function(t,e){var i=document.createElement("script");i.src=t+"JsonpReq.completeCall.call_"+e,document.body.appendChild(i),document.body.removeChild(i)},t.ajax=function(t){var e=null;"undefined"!=t.error&&("undefined"==t.timeout&&(t.timeout=12e3),e=setTimeout(t.error,t.timeout));var i=this.AnalysisParameter(t.data),n=t.url+"?"+i+t.jsonp+"=";this.process(n,function(i){null!=e&&clearTimeout(e),"undefined"!=typeof t.success&&t.success(i)})},t.AnalysisParameter=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e},t}();JsonpReq._regID=0,JsonpReq.completeCall={},JsonpReq._callBackCount=0,__reflect(JsonpReq.prototype,"JsonpReq");var SceneControl=function(){function t(){}return t.getInstance=function(){return this.stage||(this.stage=new egret.Sprite,egret.MainContext.instance.stage.addChild(this.stage)),this.stage},t.clearAllScene=function(){"undefined"!=typeof this.stage&&"undefined"!=typeof this.nowScene&&this.stage.removeChild(this.nowScene)},t.destroyEventRun=function(){destroyControl.StartDestroy()},t.run=function(t){window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},function(t){if(RES.hasRes("startMusic_mp3")){var e=RES.getRes("startMusic_mp3");e.type=egret.Sound.EFFECT,e.play(0,1).volume=0}}):document.addEventListener("WeixinJSBridgeReady",function(){window.WeixinJSBridge.invoke("getNetworkType",{},function(t){if(RES.hasRes("startMusic_mp3")){var e=RES.getRes("startMusic_mp3");e.type=egret.Sound.EFFECT,e.play(0,1).volume=0}})},!1),this.clearAllScene(),this.nowScene=t,this.getInstance().addChild(t)},t.getNowScene=function(){return this.nowScene},t.animationRun=function(t,e){var i=this;t.alpha=0,this.getInstance().addChild(t),egret.Tween.get(t).to({alpha:1},1e3).call(function(){e&&e(),i.stage.removeChild(i.nowScene),i.nowScene=t})},t}();__reflect(SceneControl.prototype,"SceneControl");var destroyControl=function(){function t(){}return t.init=function(){this.removeAllListenEvent()},t.addListenEvent=function(t,e){this.pool.push(t.bind(e))},t.StartDestroy=function(){for(var t=0;t<this.pool.length;t++)this.pool[t]();this.init()},t.removeAllListenEvent=function(){this.pool.length>0&&(this.pool=[])},t}();destroyControl.pool=[],__reflect(destroyControl.prototype,"destroyControl");var HomeScene=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){SoundControl.bgPlay(),this.rankBtn.visible=!1,this.giftBtn.visible=!1,RES.hasRes("adImg_png")&&this.addChild(new AdLayer(RES.getRes("adImg_png"))),this.playBtn.anchorOffsetX=this.playBtn.width/2,this.playBtn.anchorOffsetY=this.playBtn.height/2;var t=egret.Tween.get(this.playBtn);t.to({rotation:1800,x:315.5,y:513.5,scaleX:1,scaleY:1},1e3);var e=egret.Tween.get(this.blue,{loop:!0});e.to({x:135.5,y:922},600).to({x:135.5,y:850},600);var i=egret.Tween.get(this.pink,{loop:!0});i.to({x:283.5,y:912},650).to({x:283.5,y:862},650);var n=egret.Tween.get(this.yellow,{loop:!0});n.to({x:415.5,y:916},700).to({x:415.5,y:857},700),this.playBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playEvt,this),this.ruleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ruleEvt,this),this.rankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rankEvt,this),this.giftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.giftEvt,this)},e.prototype.playEvt=function(){SceneControl.run(new PlayScene)},e.prototype.ruleEvt=function(){this.addChild(new RuleLayer)},e.prototype.rankEvt=function(){this.addChild(new RankLayer)},e.prototype.giftEvt=function(){this.addChild(new GiftLayer)},e}(eui.Component);__reflect(HomeScene.prototype,"HomeScene",["eui.UIComponent","egret.DisplayObject"]);var OverScene=function(t){function e(e){var i=t.call(this)||this;return i.skinName="resource/scene/OverScene.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.init,i),i.scoreNum=e,i}return __extends(e,t),e.prototype.init=function(){var t=this;this.score.text=this.scoreNum.toString(),this.rankBtn.visible=!1,this.giftBtn.visible=!1;var e=egret.Tween.get(this.overSceneAni);e.to({scaleX:1,scaleY:1},500).call(function(){var e=new OverAnimalData;e.x=166.5,e.y=204,t.addChildAt(e,1)}),this.rankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rankEvt,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareEvt,this),this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.againEvt,this),this.giftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.giftEvt,this)},e.prototype.rankEvt=function(){this.addChild(new RankLayer)},e.prototype.shareEvt=function(){this.addChild(new ShareLayer)},e.prototype.againEvt=function(){SceneControl.run(new PlayScene)},e.prototype.giftEvt=function(){this.addChild(new GiftLayer)},e.prototype.submitInfo=function(t){var e=this;e.addChild(new EditerLayer)},e}(eui.Component);__reflect(OverScene.prototype,"OverScene",["eui.UIComponent","egret.DisplayObject"]);var PlayScene=function(t){function e(){var e=t.call(this)||this;return e.mapTop=50,e.mapLeft=205,e.maxRow=8,e.maxCol=6,e.clickArray=new Array,e.lineBitmapArray=new Array,e.superArray=new Array,e.type=0,e.obj=null,e.score=0,e.targetScores=1e3,e.level=1,e.seconds=20,e.timer=new egret.Timer(1e3,e.seconds),e.isEnd=!1,e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.addChild(new TipsLayer(function(){t.initTimer()})),this.initScore(),this.createAnimal()},e.prototype.initScore=function(){this.targetScore.text="1000",this.levelScore.text="0"},e.prototype.initTimer=function(){this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.endTimer,this),this.timer.start(),this.seconds>9?(this.timeTen.texture=RES.getRes(Math.floor(this.seconds/10)+"_png"),this.timeOne.texture=RES.getRes(this.seconds%10+"_png")):(this.timeTen.texture=RES.getRes("0_png"),this.timeOne.texture=RES.getRes(this.seconds+"_png"))},e.prototype.onTimer=function(){var t=this;if(this.seconds--,this.seconds>9?(this.timeTen.texture=RES.getRes(Math.floor(this.seconds/10)+"_png"),this.timeOne.texture=RES.getRes(this.seconds%10+"_png")):(this.timeTen.texture=RES.getRes("0_png"),this.timeOne.texture=RES.getRes(this.seconds+"_png")),0<this.seconds&&this.seconds<=5)this.timeAnimation();else if(0==this.seconds){var e=new egret.Timer(1e3,1);egret.Tween.removeAllTweens(),this.score>=this.targetScores?(this.reset(),this.createAnimal(),this.level++,this.targetScores+=1e3+250*this.level,this.targetScore.text=this.targetScores.toString(),e.addEventListener(egret.TimerEvent.TIMER,function(){t.seconds=20,t.timer.reset(),t.initTimer()},this)):e.addEventListener(egret.TimerEvent.TIMER,function(){t.isEnd=!0,t.addChild(new OverScene(t.score))},this),e.start()}},e.prototype.reset=function(){for(var t=0;t<this.lineBitmapArray.length;t++)this.lineBitmapArray[t].parent.removeChild(this.lineBitmapArray[t]);this.clickArray=[],this.lineBitmapArray=[];for(var e=0;e<this.obj.length;e++)for(var i=0;i<this.obj[e].length;i++)null!=this.obj[e][i]&&this.obj[e][i].parent&&(this.obj[e][i].parent.removeChild(this.obj[e][i]),this.obj[e][i]=null)},e.prototype.endTimer=function(){this.CountDownAni.visible=!1},e.prototype.createAnimal=function(){this.isEnd=!1,this.obj=new Array(this.maxRow);for(var t=0;t<this.maxRow;t++){this.obj[t]=new Array(this.maxCol);for(var e=0;e<this.maxCol;e++){var i=this.newData(t,e);this.obj[t][e]=i,this.addChildAt(i,6)}}this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.clickBeginEvt,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.clickEndEvt,this)},e.prototype.newData=function(t,e){this.type=Math.floor(4*Math.random());var i=RES.getRes("animal"+this.type+"_png"),n=new ImgData;return n.x=this.calcX(e),n.y=this.calcY(t),n.id=this.type,n.texture=i,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.row=t,n.col=e,n.touchEnabled=!0,n},e.prototype.calcX=function(t){return 90*t+this.mapTop+45},e.prototype.calcY=function(t){return 90*t+this.mapLeft+45},e.prototype.clickBeginEvt=function(t){var e=t.target,i=!1;if(void 0!=e.id&&this.isSameType(e)&&this.isSide(e))if(0==e.isSuper&&(e.texture=RES.getRes("animalD"+e.id+"_png"),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2),this.isExists(e)&&(i=!0),i&&this.isNeedRevoke(e))this.revoke();else if(!i&&(e.isSuper&&this.superArray.push(e),this.clickArray.push(e),this.clickArray.length>1)){var n,r=this.clickArray[this.clickArray.length-2],o=this.judgeDirection(e),s=Math.abs(r.row-e.row),a=Math.abs(r.col-e.col);0==s&&1==a?n=LineData.getLineToRow(r,o):1==s&&0==a?n=LineData.getLineToCol(r,o):1==s&&1==a&&(n=e.row>r.row?e.col>r.col?LineData.getLineToRightSlash(r,o):LineData.getLineToLeftSlash(r,o):e.col>r.col?LineData.getLineToLeftSlash(r,o):LineData.getLineToRightSlash(r,o)),this.lineBitmapArray.push(n),this.addChildAt(n,7)}},e.prototype.isSameType=function(t){return 0==this.clickArray.length?!0:this.clickArray[0].id==t.id?!0:!1},e.prototype.isSide=function(t){if(0==this.clickArray.length)return!0;var e=this.clickArray[this.clickArray.length-1],i=Math.abs(e.row-t.row),n=Math.abs(e.col-t.col);return 0==i&&1==n||1==i&&0==n||1==i&&1==n?!0:!1},e.prototype.isNeedRevoke=function(t){if(this.clickArray.length<2)return!1;var e=this.clickArray[this.clickArray.length-2];return e.row==t.row&&e.col==t.col?!0:!1},e.prototype.revoke=function(){var t=this.clickArray[this.clickArray.length-1],e=this.lineBitmapArray[this.lineBitmapArray.length-1];0==t.isSuper&&(t.texture=RES.getRes("animal"+t.id+"_png")),this.removeChild(e),this.clickArray.pop(),this.lineBitmapArray.pop()},e.prototype.isExists=function(t){for(var e=0;e<this.clickArray.length;e++)if(this.clickArray[e].row==t.row&&this.clickArray[e].col==t.col)return!0;return!1},e.prototype.fallData=function(){for(var t=0;t<this.maxCol;t++)this.fallOneColData(t),this.fallNewOneColData(t)},e.prototype.fallOneColData=function(t){for(var e=this.maxRow-1;e>=0;e--){var i=!1,n=this.obj[e][t];if(null!=n){for(var r,o=n.row;o<this.maxRow-1&&null==this.obj[o+1][t];)i=!0,this.obj[o][t]=null,n.row=++o,r=this.calcY(o),this.obj[o][t]=n;i&&this.fallAnimation(n,r)}}},e.prototype.fallNewOneColData=function(t){for(var e=this.maxRow-1;e>=0;e--)if(null==this.obj[e][t]){var i=-1,n=this.newData(e,t);n.y=this.calcY(i),this.addChild(n);for(var r;i<this.maxRow-1&&null==this.obj[i+1][t];)i>=0&&(this.obj[i][t]=null),n.row=++i,r=this.calcY(i),this.obj[i][t]=n;this.fallAnimation(n,r)}},e.prototype.fallAnimation=function(t,e,i){egret.Tween.get(t).wait(10,!1).to({x:t.x,y:e},300).call(function(){i&&i()})},e.prototype.clickEndEvt=function(){0==this.isEnd&&this.clearImg()},e.prototype.clearImg=function(){var t=!1;this.addScore();var e=this.clickArray.length;if(8>e)for(var i=0;e>i;i++)3>e?0==this.clickArray[i].isSuper&&(this.clickArray[i].texture=RES.getRes("animal"+this.clickArray[i].id+"_png"),this.clickArray[i].anchorOffsetX=this.clickArray[i].width/2,this.clickArray[i].anchorOffsetY=this.clickArray[i].height/2):e>=3&&8>e&&(t=!0,this.removeChild(this.clickArray[i]),this.obj[this.clickArray[i].row][this.clickArray[i].col]=null);else{e--;for(var i=0;e>i;i++)this.removeChild(this.clickArray[0]),this.obj[this.clickArray[0].row][this.clickArray[0].col]=null,this.clickArray.splice(0,1);0==this.superArray.length?(this.clickArray[0].isSuper=!0,this.clickArray[0].texture=RES.getRes("animalT"+this.clickArray[0].id+"_png"),this.clickArray[0].anchorOffsetX=this.clickArray[0].width/2,this.clickArray[0].anchorOffsetY=this.clickArray[0].height/2,this.clickArray[0].superNum=e+1):(this.removeChild(this.clickArray[0]),this.obj[this.clickArray[0].row][this.clickArray[0].col]=null,this.clickArray.splice(0,1)),t=!0}if(this.superArray.length>0&&e>=3)for(var n=0;n<this.obj.length;n++)for(var r=0;r<this.obj[n].length;r++)for(var i=0;i<this.superArray.length;i++)null!=this.obj[n][r]&&null!=this.superArray[i]&&this.obj[n][r].id==this.superArray[i].id&&(this.obj[n][r].parent.removeChild(this.obj[n][r]),this.obj[n][r]=null,t=!0);this.superArray=[],this.levelScore.text=this.score.toString();for(var i=0;i<this.lineBitmapArray.length;i++)this.removeChild(this.lineBitmapArray[i]);this.clickArray=[],this.lineBitmapArray=[],t&&this.fallData()},e.prototype.addScore=function(){if(!(this.clickArray.length<3)){for(var t=this.clickArray.length,e=0;e<this.clickArray.length;e++)this.clickArray[e].isSuper&&(t+=this.clickArray[e].superNum);var i=5*t;this.score+=i*t}},e.prototype.judgeDirection=function(t){var e=this.clickArray[this.clickArray.length-2],i=Math.abs(e.row-t.row),n=Math.abs(e.col-t.col);return 0==i?t.col>e.col?new DirectionData(1,0):new DirectionData(-1,0):0==n?t.row>e.row?new DirectionData(0,1):new DirectionData(0,-1):1==i&&1==n?t.row>e.row?t.col>e.col?new DirectionData(1,1):new DirectionData(-1,1):t.col>e.col?new DirectionData(1,-1):new DirectionData(-1,-1):void 0},e.prototype.timeAnimation=function(){this.CountDownAni.visible=!0,this.CountDownAni.alpha=0;var t=this,e=egret.Tween.get(this.CountDownAni);e.wait(500).call(function(){t.CountDownAni.alpha=1})},e}(eui.Component);__reflect(PlayScene.prototype,"PlayScene",["eui.UIComponent","egret.DisplayObject"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);